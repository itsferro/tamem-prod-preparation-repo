<!-- learning-journey.component.html -->
<div class="learning-journey-wrapper">
  <!-- Header with stepper - only show when journey is in progress -->
  @if (!showJourneyIntro && journeyData) {
    <div class="journey-header">
      <journey-stepper 
        [currentStep]="currentStepIndex" 
        [totalSteps]="journeyData?.steps.length || 0">
      </journey-stepper>
    </div>
  }

  <!-- Main content area -->
  <div class="journey-content">
    <!-- Journey intro screen with map -->
    @if (showJourneyIntro && journeyData) {
      <div class="journey-intro" [@fadeIn]>
        <!-- Journey Map Component -->
        <div class="journey-map-wrapper">
          <journey-map
          [steps]="journeyData.steps"
          [currentStepIndex]="currentStepIndex"
          [lessonTitle]="block?.title || 'رحلة التعلم'"
          (nodeSelected)="onMapNodeSelected($event)"
          (retake)="onRetakeChallenge($event)"
          (exitJourney)="onExitJourney()">
        </journey-map>
        </div>
      </div>
    }
    
    <!-- Challenge component - shown during journey -->
    @if (showChallenge && journeyData) {
      <journey-challenge
        [currentStep]="journeyData.steps[currentStepIndex]"
        [blockData]="block"
        (challengeResponse)="onChallengeResponse($event)" 
        [@fadeIn]>
      </journey-challenge>
    }
  </div>
</div>