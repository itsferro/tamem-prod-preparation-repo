<!-- ali.component.html -->
<div class="place-value-container" dir="rtl">
    <h1 class="title">فهم الأعداد الكلية حتى مليون</h1>
    
    <div class="number-display" [@numberGrow]="numberAnimation">
      @if (displayNumber) {
        <span>{{ displayNumber }}</span>
      }
    </div>
    
    <div class="number-in-words" [class.active]="numberInWords">
      {{ numberInWords }}
    </div>
    
    <div class="place-value-chart">
      <!-- Headers -->
      @for (name of placeValueNames; track $index) {
        <div class="header-cell" [ngClass]="placeValueClasses[$index]">
          {{ name }}
        </div>
      }
      
      <!-- Value cells -->
      @for (digit of digits; track $index) {
        <div class="value-cell" 
             [ngClass]="placeValueClasses[$index]"
             [@cellHighlight]="digit.highlight">
          <span class="digit" [@digitAnimation]="digit.state">
            {{ digit.value }}
          </span>
        </div>
      }
    </div>
    
    <!-- Explanations based on current number - modified to always show -->
    <div class="explanation">
      @if (displayNumber === '10000') {
        <div class="explanation-card" [@fadeInOut]>
          <p>في العدد <strong>10,000</strong> (عشرة آلاف):</p>
          <ul>
            <li>الرقم 1 في خانة <strong>عشرات الآلاف</strong> ويساوي 10,000</li>
            <li>باقي الخانات تحتوي على أصفار</li>
          </ul>
        </div>
      }
      
      @if (displayNumber === '100000') {
        <div class="explanation-card" [@fadeInOut]>
          <p>في العدد <strong>100,000</strong> (مائة ألف):</p>
          <ul>
            <li>الرقم 1 في خانة <strong>مئات الآلاف</strong> ويساوي 100,000</li>
            <li>نلاحظ أن: 10 عشرات آلاف = 1 مائة ألف</li>
          </ul>
        </div>
      }
      
      @if (displayNumber === '503962') {
        <div class="explanation-card" [@fadeInOut]>
          <p>في العدد <strong>503,962</strong>:</p>
          <ul>
            <li>الرقم 5 في خانة <strong>مئات الآلاف</strong> ويساوي 500,000</li>
            <li>الرقم 3 في خانة <strong>آلاف</strong> ويساوي 3,000</li>
            <li>الرقم 9 في خانة <strong>مئات</strong> ويساوي 900</li>
            <li>الرقم 6 في خانة <strong>عشرات</strong> ويساوي 60</li>
            <li>الرقم 2 في خانة <strong>آحاد</strong> ويساوي 2</li>
          </ul>
        </div>
      }
  
      @if (displayNumber === '861257') {
        <div class="explanation-card" [@fadeInOut]>
          <p>في العدد <strong>861,257</strong>:</p>
          <ul>
            <li>الرقم 8 في خانة <strong>مئات الآلاف</strong> ويساوي 800,000</li>
            <li>الرقم 6 في خانة <strong>عشرات الآلاف</strong> ويساوي 60,000</li>
            <li>الرقم 1 في خانة <strong>آلاف</strong> ويساوي 1,000</li>
            <li>الرقم 2 في خانة <strong>مئات</strong> ويساوي 200</li>
            <li>الرقم 5 في خانة <strong>عشرات</strong> ويساوي 50</li>
            <li>الرقم 7 في خانة <strong>آحاد</strong> ويساوي 7</li>
          </ul>
        </div>
      }
  
      @if (displayNumber === '1000000') {
        <div class="explanation-card" [@fadeInOut]>
          <p>في العدد <strong>1,000,000</strong> (مليون):</p>
          <ul>
            <li>الرقم 1 في خانة <strong>مليون</strong> ويساوي 1,000,000</li>
            <li>باقي الخانات تحتوي على أصفار</li>
            <li>المليون يساوي 10 مئات ألف</li>
          </ul>
        </div>
      }
    </div>
    
    <div class="controls">
      @for (example of examples; track $index) {
        <button (click)="manualExample($index)" 
                [class.active]="isActive($index)"
                [disabled]="isAnimating">
          {{ example.number }}
        </button>
      }
      <button (click)="resetStates()" 
              class="reset-btn"
              [disabled]="isAnimating || !displayNumber">
        إعادة ضبط
      </button>
    </div>
    
    <div class="auto-play-controls">
      <button (click)="startAutoPlay()" 
              [disabled]="isAutoPlaying || isAnimating" 
              class="play-btn">
        <span class="play-icon">▶</span> تشغيل تلقائي
      </button>
      <button (click)="stopAutoPlay()" 
              [disabled]="!isAutoPlaying" 
              class="stop-btn">
        <span class="stop-icon">■</span> إيقاف
      </button>
    </div>
    
    <!-- Progress indicators for autoplay -->
    @if (isAutoPlaying) {
      <div class="progress-indicators">
        @for (example of examples; track $index) {
          <div class="progress-dot"
               [class.active]="isActive($index)"></div>
        }
      </div>
    }
  </div>