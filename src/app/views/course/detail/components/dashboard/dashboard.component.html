<div class="challenges-dashboard" dir="rtl" lang="ar">
    <div class="challenges-header">
      <h2>تحديات التقييم: {{lessonTitle}}</h2>
      <div class="progress-summary">
        <div class="progress-circle">
          <svg viewBox="0 0 36 36">
            <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
            <path class="circle-progress" [attr.stroke-dasharray]="progressPercentage + ', 100'" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
            <text x="18" y="20.35" class="percentage">{{completedChallenges}}/{{totalChallenges}}</text>
          </svg>
        </div>
        <div class="score-display">
          <span class="score-label">النتيجة الحالية</span>
          <span class="score-value">{{currentScore}}/{{totalPossibleScore}}</span>
        </div>
      </div>
    </div>
  
    <div class="challenges-intro">
      <p>أكمل التحديات التالية لإثبات فهمك للدرس. عليك إكمال جميع التحديات للحصول على الدرجة الكاملة.</p>
    </div>
  
    <div class="challenges-list">
      @for (challenge of challenges; track challenge.id) {
        <div class="challenge-card" [class.completed]="challenge.completed" [class.locked]="challenge.locked">
          <div class="challenge-icon">
            <i class="fa {{challenge.icon}}"></i>
          </div>
          <div class="challenge-content">
            <h3>{{challenge.title}}</h3>
            <p>{{challenge.description}}</p>
            <div class="challenge-meta">
              <span class="difficulty" [class]="'difficulty-' + challenge.difficulty">
                {{getDifficultyText(challenge.difficulty)}}
              </span>
              <span class="points">{{challenge.points}} نقطة</span>
            </div>
          </div>
          <div class="challenge-status">
            @if (challenge.completed) {
              <div class="status-badge completed">
                <i class="fa fa-check-circle"></i> مكتمل
              </div>
            } @else if (challenge.locked) {
              <div class="status-badge locked">
                <i class="fa fa-lock"></i> مقفل
              </div>
            } @else {
              <button class="start-challenge-btn" (click)="startChallenge(challenge.id)">
                ابدأ التحدي
              </button>
            }
          </div>
        </div>
      }
    </div>
  
    <div class="challenges-footer">
      <div class="footer-note">
        <i class="fa fa-info-circle"></i>
        <span>أكمل جميع التحديات للانتقال إلى الدرس التالي</span>
      </div>
      <button class="next-lesson-btn" [disabled]="completedChallenges < totalChallenges">
        الدرس التالي <i class="fa fa-arrow-left"></i>
      </button>
    </div>
  </div>
  